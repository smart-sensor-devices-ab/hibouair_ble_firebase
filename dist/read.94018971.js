var e;document.getElementById("exportData").addEventListener("click",(function(){let e=document.getElementById("database").value,t=document.getElementById("ref").value;e?fetch(e+"/"+t+".json").then((e=>e.json())).then((e=>{const t=function(e){const t=[],l=["ts",...Object.keys(e[Object.keys(e)[0]])];t.push(l.join(","));for(const l in e){const n=[e[l].ts,...Object.values(e[l])];t.push(n.join(","))}return t.join("\n")}(e),l=new Blob([t],{type:"text/csv"}),n=document.createElement("a");n.href=URL.createObjectURL(l),n.download="hibouair_data.csv",document.body.appendChild(n),n.click(),document.body.removeChild(n)})).catch((e=>console.error("Error fetching data:",e))):document.getElementById("log").innerHTML="Database URL missing"})),document.getElementById("formSubmit").addEventListener("submit",(function(t){t.preventDefault();let l=parseInt(document.getElementById("date-choose").value),n=document.getElementById("database").value,o=document.getElementById("ref").value;fetch(n+"/"+o+".json").then((e=>e.json())).then((t=>{let n=[];n=0!=l?function(e,t){const l={};let n;n=new Date((new Date).getTime()-864e5*(t-1));for(const t in e){const o=e[t],a=new Date(o.ts);a.getFullYear()===n.getFullYear()&&a.getMonth()===n.getMonth()&&a.getDate()===n.getDate()&&(l[t]=o)}return l}(t,l):t;const o=function(e,t){const l=[];let n=[e[0]];for(let o=1;o<e.length;o++){new Date(e[o])-new Date(e[o-1])<t?n.push(e[o]):(l.push(n),n=[e[o]])}return l.push(n),l}(Object.values(n).map((e=>e.ts)),5e3).map((e=>e[0])),a=[...new Set(Object.values(n).map((e=>e.boardID)))],r=(e,t)=>e.map((e=>e[t])),d=a.flatMap((e=>{const t=Object.values(n).filter((t=>t.boardID===e)),l=t[0].type;let o=null,a=null,d=null,c=null;return 4===l?o={label:`${e} - CO2`,data:r(t,"co2"),borderColor:"#4285F4",fill:!1}:3===l&&(a={label:`${e} - PM1`,data:r(t,"pm1"),borderColor:"#DB4437",fill:!1},d={label:`${e} - PM2.5`,data:r(t,"pm25"),borderColor:"#F4B400",fill:!1},c={label:`${e} - PM10`,data:r(t,"pm10"),borderColor:"#0F9D58",fill:!1}),[{label:`${e} - Temperature`,data:r(t,"temp"),borderColor:"#273c75",fill:!1},{label:`${e} - Humidity`,data:r(t,"hum"),borderColor:"#8c7ae6",fill:!1},{label:`${e} - Pressure`,data:r(t,"pressure"),borderColor:"#6D214F",fill:!1},{label:`${e} - VOC`,data:r(t,"voc"),borderColor:"#F97F51",fill:!1},o,a,d,c].filter(Boolean)})),c=document.getElementById("myChart").getContext("2d");null!=e&&e.destroy(),e=new Chart(c,{type:"line",data:{labels:o,datasets:d},options:{}})}))}));
//# sourceMappingURL=read.94018971.js.map
